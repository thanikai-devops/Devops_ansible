@Library ('my_shared_library') _ 

pipeline {
    agent {
        label "node-1"
    }
    environment{

    }
    stages{
        stage("checkout SCM"){
            steps{
                script{
                    echo "******************* Sportsdata *******************"
                    gitcheckout("https://SciflareIT@bitbucket.org/fantasysportpro/fantasypro_sportsdata.git","master")
                }
            }
        }
        stage("Stoping Old Dockercontainers"){
            steps{
                script{
                    echo "*** Docker compose containers ***" 
                    dockercleanup.dockercontainercompose()
                }
            }
        }
        stage("Remove Old DockerImages And Containers"){
            steps{
                script{
                    echo "*** Delete Old Images ***"
                    sh "docker system prune -a -f"
                }
            }
        }
        stage("Docker Compose Up"){
            steps{
                script{
                    sh "docker compose up -d api cron"
                    sh "docker images && docker ps"
                }
            }
        }
    }
}